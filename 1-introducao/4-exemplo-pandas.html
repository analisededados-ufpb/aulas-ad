<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-0.9.653">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Aulas AD 1 – exemplo-pandas</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Aulas AD 1</span>
  </a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html">Home</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://github.com/analisededados-ufpb/aulas-ad">GitHub</a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#exemplo-pandas" id="toc-exemplo-pandas" class="nav-link active" data-scroll-target="#exemplo-pandas">Exemplo Pandas</a>
  <ul class="collapse">
  <li><a href="#carregamento-de-dados" id="toc-carregamento-de-dados" class="nav-link" data-scroll-target="#carregamento-de-dados">Carregamento de dados</a></li>
  <li><a href="#adicionando-novas-colunas" id="toc-adicionando-novas-colunas" class="nav-link" data-scroll-target="#adicionando-novas-colunas">Adicionando novas colunas</a></li>
  <li><a href="#filtrando-dados" id="toc-filtrando-dados" class="nav-link" data-scroll-target="#filtrando-dados">Filtrando dados</a></li>
  <li><a href="#agrupando-por-coluna-e-sumarizando-dados" id="toc-agrupando-por-coluna-e-sumarizando-dados" class="nav-link" data-scroll-target="#agrupando-por-coluna-e-sumarizando-dados">Agrupando por coluna e sumarizando dados</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">



<section id="exemplo-pandas" class="level1">
<h1>Exemplo Pandas</h1>
<p>Vamos usar um exemplo de análise para demonstrar mais funções da biblioteca Pandas de Python.</p>
<section id="carregamento-de-dados" class="level2">
<h2 class="anchored" data-anchor-id="carregamento-de-dados">Carregamento de dados</h2>
<p>O primeiro passo será carregar os dados de um arquivo <em>CSV</em>. Vamos carregar o arquivo que possui as notas das 4 unidades da disciplina Sistemas Operacionais no período 2017.1. O parâmetro <code>index_col="id"</code> indica que a coluna <code>id</code> que consta no arquivo será o identificar das linhas do <em>DataFrame</em>.</p>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>so_20171 <span class="op">=</span> pd.read_csv(<span class="st">"../dados/notas_so_20171.csv"</span>, index_col<span class="op">=</span><span class="st">"id"</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>so_20171</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>nota_1</th>
      <th>nota_2</th>
      <th>nota_3</th>
      <th>nota_4</th>
    </tr>
    <tr>
      <th>id</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>8.3</td>
      <td>8.0</td>
      <td>9.3</td>
      <td>8.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>7.0</td>
      <td>7.7</td>
      <td>4.6</td>
      <td>8.7</td>
    </tr>
    <tr>
      <th>3</th>
      <td>7.8</td>
      <td>3.2</td>
      <td>7.7</td>
      <td>5.1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>7.3</td>
      <td>9.3</td>
      <td>9.8</td>
      <td>4.8</td>
    </tr>
    <tr>
      <th>5</th>
      <td>5.8</td>
      <td>9.8</td>
      <td>10.0</td>
      <td>6.8</td>
    </tr>
    <tr>
      <th>6</th>
      <td>9.6</td>
      <td>9.8</td>
      <td>10.0</td>
      <td>9.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>9.0</td>
      <td>8.5</td>
      <td>8.5</td>
      <td>8.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>4.0</td>
      <td>7.5</td>
      <td>5.3</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>10.0</td>
      <td>9.9</td>
      <td>9.6</td>
      <td>9.1</td>
    </tr>
    <tr>
      <th>10</th>
      <td>8.3</td>
      <td>8.7</td>
      <td>8.0</td>
      <td>6.7</td>
    </tr>
    <tr>
      <th>11</th>
      <td>10.0</td>
      <td>10.0</td>
      <td>8.5</td>
      <td>9.8</td>
    </tr>
    <tr>
      <th>12</th>
      <td>7.3</td>
      <td>9.0</td>
      <td>7.8</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>13</th>
      <td>8.8</td>
      <td>9.2</td>
      <td>10.0</td>
      <td>8.7</td>
    </tr>
    <tr>
      <th>14</th>
      <td>6.5</td>
      <td>8.6</td>
      <td>7.0</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>15</th>
      <td>10.0</td>
      <td>8.5</td>
      <td>8.1</td>
      <td>8.5</td>
    </tr>
    <tr>
      <th>16</th>
      <td>9.7</td>
      <td>10.0</td>
      <td>7.7</td>
      <td>7.5</td>
    </tr>
    <tr>
      <th>17</th>
      <td>8.3</td>
      <td>9.7</td>
      <td>8.7</td>
      <td>6.8</td>
    </tr>
    <tr>
      <th>18</th>
      <td>7.5</td>
      <td>9.4</td>
      <td>6.0</td>
      <td>7.2</td>
    </tr>
    <tr>
      <th>19</th>
      <td>9.3</td>
      <td>9.9</td>
      <td>9.8</td>
      <td>9.1</td>
    </tr>
    <tr>
      <th>20</th>
      <td>0.0</td>
      <td>2.5</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>21</th>
      <td>5.0</td>
      <td>8.0</td>
      <td>5.8</td>
      <td>4.8</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>Podemos usar o comando <code>info()</code> para obter informações sobre os tipos das colunas e a presença de dados nulos:</p>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>so_20171.info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
Int64Index: 21 entries, 1 to 21
Data columns (total 4 columns):
 #   Column  Non-Null Count  Dtype  
---  ------  --------------  -----  
 0   nota_1  21 non-null     float64
 1   nota_2  21 non-null     float64
 2   nota_3  21 non-null     float64
 3   nota_4  21 non-null     float64
dtypes: float64(4)
memory usage: 840.0 bytes</code></pre>
</div>
</div>
<p>Outra função útil é a <code>describe()</code>, que calcula estatísticas básicas para as colunas de um <em>DataFrame</em>:</p>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>so_20171.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>nota_1</th>
      <th>nota_2</th>
      <th>nota_3</th>
      <th>nota_4</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>21.000000</td>
      <td>21.000000</td>
      <td>21.000000</td>
      <td>21.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>7.595238</td>
      <td>8.438095</td>
      <td>7.771429</td>
      <td>6.742857</td>
    </tr>
    <tr>
      <th>std</th>
      <td>2.408003</td>
      <td>2.020266</td>
      <td>2.242129</td>
      <td>2.510492</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.000000</td>
      <td>2.500000</td>
      <td>1.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>7.000000</td>
      <td>8.000000</td>
      <td>7.000000</td>
      <td>5.100000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>8.300000</td>
      <td>9.000000</td>
      <td>8.100000</td>
      <td>7.200000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>9.300000</td>
      <td>9.800000</td>
      <td>9.600000</td>
      <td>8.700000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>10.000000</td>
      <td>10.000000</td>
      <td>10.000000</td>
      <td>9.800000</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>Já vimos que para calcular a média das notas de cada unidade podemos fazer:</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>so_20171.mean(numeric_only<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<pre><code>nota_1    7.595238
nota_2    8.438095
nota_3    7.771429
nota_4    6.742857
dtype: float64</code></pre>
</div>
</div>
<p>Suponha que queremos calcular a média das notas de cada uma das 4 unidades para todas as turmas de SO nos últimos 10 períodos. Para fazer do modo acima, precisaríamos de pelo menos 10 linhas de código, uma para cada turma. Isso não parece muito interessante. O jeito mais eficiente de fazer isso é juntando todos os dados em uma única tabela.</p>
<p>Vamos fazer um exemplo carregando os dados de mais um período:</p>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>so_20172 <span class="op">=</span> pd.read_csv(<span class="st">"../dados/notas_so_20172.csv"</span>, index_col<span class="op">=</span><span class="st">"id"</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>so_20172</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>nota_1</th>
      <th>nota_2</th>
      <th>nota_3</th>
      <th>nota_4</th>
    </tr>
    <tr>
      <th>id</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>9.8</td>
      <td>9.7</td>
      <td>9.5</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>9.2</td>
      <td>9.8</td>
      <td>7.0</td>
      <td>7.2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>9.1</td>
      <td>8.0</td>
      <td>9.5</td>
      <td>8.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5.6</td>
      <td>7.8</td>
      <td>8.5</td>
      <td>6.5</td>
    </tr>
    <tr>
      <th>5</th>
      <td>6.3</td>
      <td>8.0</td>
      <td>6.3</td>
      <td>5.5</td>
    </tr>
    <tr>
      <th>6</th>
      <td>6.6</td>
      <td>6.7</td>
      <td>7.2</td>
      <td>3.8</td>
    </tr>
    <tr>
      <th>7</th>
      <td>9.3</td>
      <td>9.0</td>
      <td>9.2</td>
      <td>8.5</td>
    </tr>
    <tr>
      <th>8</th>
      <td>9.0</td>
      <td>10.0</td>
      <td>8.7</td>
      <td>8.1</td>
    </tr>
    <tr>
      <th>9</th>
      <td>7.8</td>
      <td>8.5</td>
      <td>9.0</td>
      <td>7.5</td>
    </tr>
    <tr>
      <th>10</th>
      <td>7.5</td>
      <td>8.0</td>
      <td>9.0</td>
      <td>5.3</td>
    </tr>
    <tr>
      <th>11</th>
      <td>8.3</td>
      <td>9.0</td>
      <td>5.2</td>
      <td>6.2</td>
    </tr>
    <tr>
      <th>12</th>
      <td>7.5</td>
      <td>9.8</td>
      <td>8.2</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>13</th>
      <td>7.7</td>
      <td>7.3</td>
      <td>4.5</td>
      <td>6.5</td>
    </tr>
    <tr>
      <th>14</th>
      <td>5.8</td>
      <td>7.5</td>
      <td>6.5</td>
      <td>6.2</td>
    </tr>
    <tr>
      <th>15</th>
      <td>7.8</td>
      <td>9.3</td>
      <td>8.8</td>
      <td>4.5</td>
    </tr>
    <tr>
      <th>16</th>
      <td>0.0</td>
      <td>2.5</td>
      <td>2.0</td>
      <td>3.5</td>
    </tr>
    <tr>
      <th>17</th>
      <td>5.8</td>
      <td>8.3</td>
      <td>7.5</td>
      <td>3.5</td>
    </tr>
    <tr>
      <th>18</th>
      <td>9.6</td>
      <td>9.0</td>
      <td>10.0</td>
      <td>5.5</td>
    </tr>
    <tr>
      <th>19</th>
      <td>7.0</td>
      <td>6.7</td>
      <td>6.6</td>
      <td>8.0</td>
    </tr>
    <tr>
      <th>20</th>
      <td>7.3</td>
      <td>8.6</td>
      <td>7.3</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>21</th>
      <td>9.5</td>
      <td>8.8</td>
      <td>7.8</td>
      <td>6.2</td>
    </tr>
    <tr>
      <th>22</th>
      <td>2.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>23</th>
      <td>7.3</td>
      <td>8.0</td>
      <td>6.7</td>
      <td>7.5</td>
    </tr>
    <tr>
      <th>24</th>
      <td>9.5</td>
      <td>8.8</td>
      <td>7.0</td>
      <td>8.3</td>
    </tr>
    <tr>
      <th>25</th>
      <td>9.7</td>
      <td>9.0</td>
      <td>3.4</td>
      <td>7.4</td>
    </tr>
    <tr>
      <th>26</th>
      <td>8.9</td>
      <td>6.7</td>
      <td>5.5</td>
      <td>4.5</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</section>
<section id="adicionando-novas-colunas" class="level2">
<h2 class="anchored" data-anchor-id="adicionando-novas-colunas">Adicionando novas colunas</h2>
<p>Note que a sua estrutura é semelhante à do <em>DataFrame</em> anterior. Desta forma, podemos juntá-los em um único data frame. Antes disso, temos que adicionar uma nova coluna que identifique o período que as notas se referem:</p>
<div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>so_20171[<span class="st">"periodo"</span>] <span class="op">=</span> <span class="st">"2017.1"</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>so_20171.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>nota_1</th>
      <th>nota_2</th>
      <th>nota_3</th>
      <th>nota_4</th>
      <th>periodo</th>
    </tr>
    <tr>
      <th>id</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>8.3</td>
      <td>8.0</td>
      <td>9.3</td>
      <td>8.0</td>
      <td>2017.1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>7.0</td>
      <td>7.7</td>
      <td>4.6</td>
      <td>8.7</td>
      <td>2017.1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>7.8</td>
      <td>3.2</td>
      <td>7.7</td>
      <td>5.1</td>
      <td>2017.1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>7.3</td>
      <td>9.3</td>
      <td>9.8</td>
      <td>4.8</td>
      <td>2017.1</td>
    </tr>
    <tr>
      <th>5</th>
      <td>5.8</td>
      <td>9.8</td>
      <td>10.0</td>
      <td>6.8</td>
      <td>2017.1</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>so_20172[<span class="st">"periodo"</span>] <span class="op">=</span> <span class="st">"2017.2"</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>so_20172.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>nota_1</th>
      <th>nota_2</th>
      <th>nota_3</th>
      <th>nota_4</th>
      <th>periodo</th>
    </tr>
    <tr>
      <th>id</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>9.8</td>
      <td>9.7</td>
      <td>9.5</td>
      <td>7.0</td>
      <td>2017.2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>9.2</td>
      <td>9.8</td>
      <td>7.0</td>
      <td>7.2</td>
      <td>2017.2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>9.1</td>
      <td>8.0</td>
      <td>9.5</td>
      <td>8.0</td>
      <td>2017.2</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5.6</td>
      <td>7.8</td>
      <td>8.5</td>
      <td>6.5</td>
      <td>2017.2</td>
    </tr>
    <tr>
      <th>5</th>
      <td>6.3</td>
      <td>8.0</td>
      <td>6.3</td>
      <td>5.5</td>
      <td>2017.2</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>O comando <code>head()</code> mostra apenas as primeiras 5 linhas da tabela.</p>
<p>Como os dois <em>DataFrames</em> possuem a mesma estrutura, podemos juntá-los com a função <a href="https://pandas.pydata.org/docs/reference/api/pandas.concat.html"><code>concat</code></a>:</p>
<div class="cell" data-execution_count="50">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>so <span class="op">=</span> pd.concat([so_20171, so_20172])</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>so</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="50">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>nota_1</th>
      <th>nota_2</th>
      <th>nota_3</th>
      <th>nota_4</th>
      <th>periodo</th>
    </tr>
    <tr>
      <th>id</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>8.3</td>
      <td>8.0</td>
      <td>9.3</td>
      <td>8.0</td>
      <td>2017.1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>7.0</td>
      <td>7.7</td>
      <td>4.6</td>
      <td>8.7</td>
      <td>2017.1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>7.8</td>
      <td>3.2</td>
      <td>7.7</td>
      <td>5.1</td>
      <td>2017.1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>7.3</td>
      <td>9.3</td>
      <td>9.8</td>
      <td>4.8</td>
      <td>2017.1</td>
    </tr>
    <tr>
      <th>5</th>
      <td>5.8</td>
      <td>9.8</td>
      <td>10.0</td>
      <td>6.8</td>
      <td>2017.1</td>
    </tr>
    <tr>
      <th>6</th>
      <td>9.6</td>
      <td>9.8</td>
      <td>10.0</td>
      <td>9.0</td>
      <td>2017.1</td>
    </tr>
    <tr>
      <th>7</th>
      <td>9.0</td>
      <td>8.5</td>
      <td>8.5</td>
      <td>8.0</td>
      <td>2017.1</td>
    </tr>
    <tr>
      <th>8</th>
      <td>4.0</td>
      <td>7.5</td>
      <td>5.3</td>
      <td>2.0</td>
      <td>2017.1</td>
    </tr>
    <tr>
      <th>9</th>
      <td>10.0</td>
      <td>9.9</td>
      <td>9.6</td>
      <td>9.1</td>
      <td>2017.1</td>
    </tr>
    <tr>
      <th>10</th>
      <td>8.3</td>
      <td>8.7</td>
      <td>8.0</td>
      <td>6.7</td>
      <td>2017.1</td>
    </tr>
    <tr>
      <th>11</th>
      <td>10.0</td>
      <td>10.0</td>
      <td>8.5</td>
      <td>9.8</td>
      <td>2017.1</td>
    </tr>
    <tr>
      <th>12</th>
      <td>7.3</td>
      <td>9.0</td>
      <td>7.8</td>
      <td>7.0</td>
      <td>2017.1</td>
    </tr>
    <tr>
      <th>13</th>
      <td>8.8</td>
      <td>9.2</td>
      <td>10.0</td>
      <td>8.7</td>
      <td>2017.1</td>
    </tr>
    <tr>
      <th>14</th>
      <td>6.5</td>
      <td>8.6</td>
      <td>7.0</td>
      <td>4.0</td>
      <td>2017.1</td>
    </tr>
    <tr>
      <th>15</th>
      <td>10.0</td>
      <td>8.5</td>
      <td>8.1</td>
      <td>8.5</td>
      <td>2017.1</td>
    </tr>
    <tr>
      <th>16</th>
      <td>9.7</td>
      <td>10.0</td>
      <td>7.7</td>
      <td>7.5</td>
      <td>2017.1</td>
    </tr>
    <tr>
      <th>17</th>
      <td>8.3</td>
      <td>9.7</td>
      <td>8.7</td>
      <td>6.8</td>
      <td>2017.1</td>
    </tr>
    <tr>
      <th>18</th>
      <td>7.5</td>
      <td>9.4</td>
      <td>6.0</td>
      <td>7.2</td>
      <td>2017.1</td>
    </tr>
    <tr>
      <th>19</th>
      <td>9.3</td>
      <td>9.9</td>
      <td>9.8</td>
      <td>9.1</td>
      <td>2017.1</td>
    </tr>
    <tr>
      <th>20</th>
      <td>0.0</td>
      <td>2.5</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>2017.1</td>
    </tr>
    <tr>
      <th>21</th>
      <td>5.0</td>
      <td>8.0</td>
      <td>5.8</td>
      <td>4.8</td>
      <td>2017.1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>9.8</td>
      <td>9.7</td>
      <td>9.5</td>
      <td>7.0</td>
      <td>2017.2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>9.2</td>
      <td>9.8</td>
      <td>7.0</td>
      <td>7.2</td>
      <td>2017.2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>9.1</td>
      <td>8.0</td>
      <td>9.5</td>
      <td>8.0</td>
      <td>2017.2</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5.6</td>
      <td>7.8</td>
      <td>8.5</td>
      <td>6.5</td>
      <td>2017.2</td>
    </tr>
    <tr>
      <th>5</th>
      <td>6.3</td>
      <td>8.0</td>
      <td>6.3</td>
      <td>5.5</td>
      <td>2017.2</td>
    </tr>
    <tr>
      <th>6</th>
      <td>6.6</td>
      <td>6.7</td>
      <td>7.2</td>
      <td>3.8</td>
      <td>2017.2</td>
    </tr>
    <tr>
      <th>7</th>
      <td>9.3</td>
      <td>9.0</td>
      <td>9.2</td>
      <td>8.5</td>
      <td>2017.2</td>
    </tr>
    <tr>
      <th>8</th>
      <td>9.0</td>
      <td>10.0</td>
      <td>8.7</td>
      <td>8.1</td>
      <td>2017.2</td>
    </tr>
    <tr>
      <th>9</th>
      <td>7.8</td>
      <td>8.5</td>
      <td>9.0</td>
      <td>7.5</td>
      <td>2017.2</td>
    </tr>
    <tr>
      <th>10</th>
      <td>7.5</td>
      <td>8.0</td>
      <td>9.0</td>
      <td>5.3</td>
      <td>2017.2</td>
    </tr>
    <tr>
      <th>11</th>
      <td>8.3</td>
      <td>9.0</td>
      <td>5.2</td>
      <td>6.2</td>
      <td>2017.2</td>
    </tr>
    <tr>
      <th>12</th>
      <td>7.5</td>
      <td>9.8</td>
      <td>8.2</td>
      <td>6.0</td>
      <td>2017.2</td>
    </tr>
    <tr>
      <th>13</th>
      <td>7.7</td>
      <td>7.3</td>
      <td>4.5</td>
      <td>6.5</td>
      <td>2017.2</td>
    </tr>
    <tr>
      <th>14</th>
      <td>5.8</td>
      <td>7.5</td>
      <td>6.5</td>
      <td>6.2</td>
      <td>2017.2</td>
    </tr>
    <tr>
      <th>15</th>
      <td>7.8</td>
      <td>9.3</td>
      <td>8.8</td>
      <td>4.5</td>
      <td>2017.2</td>
    </tr>
    <tr>
      <th>16</th>
      <td>0.0</td>
      <td>2.5</td>
      <td>2.0</td>
      <td>3.5</td>
      <td>2017.2</td>
    </tr>
    <tr>
      <th>17</th>
      <td>5.8</td>
      <td>8.3</td>
      <td>7.5</td>
      <td>3.5</td>
      <td>2017.2</td>
    </tr>
    <tr>
      <th>18</th>
      <td>9.6</td>
      <td>9.0</td>
      <td>10.0</td>
      <td>5.5</td>
      <td>2017.2</td>
    </tr>
    <tr>
      <th>19</th>
      <td>7.0</td>
      <td>6.7</td>
      <td>6.6</td>
      <td>8.0</td>
      <td>2017.2</td>
    </tr>
    <tr>
      <th>20</th>
      <td>7.3</td>
      <td>8.6</td>
      <td>7.3</td>
      <td>0.0</td>
      <td>2017.2</td>
    </tr>
    <tr>
      <th>21</th>
      <td>9.5</td>
      <td>8.8</td>
      <td>7.8</td>
      <td>6.2</td>
      <td>2017.2</td>
    </tr>
    <tr>
      <th>22</th>
      <td>2.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>2017.2</td>
    </tr>
    <tr>
      <th>23</th>
      <td>7.3</td>
      <td>8.0</td>
      <td>6.7</td>
      <td>7.5</td>
      <td>2017.2</td>
    </tr>
    <tr>
      <th>24</th>
      <td>9.5</td>
      <td>8.8</td>
      <td>7.0</td>
      <td>8.3</td>
      <td>2017.2</td>
    </tr>
    <tr>
      <th>25</th>
      <td>9.7</td>
      <td>9.0</td>
      <td>3.4</td>
      <td>7.4</td>
      <td>2017.2</td>
    </tr>
    <tr>
      <th>26</th>
      <td>8.9</td>
      <td>6.7</td>
      <td>5.5</td>
      <td>4.5</td>
      <td>2017.2</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>E se quisermos saber as médias de cada período específico, usando a tabela com todas as notas? Vamos mostrar duas formas de fazer isso.</p>
</section>
<section id="filtrando-dados" class="level2">
<h2 class="anchored" data-anchor-id="filtrando-dados">Filtrando dados</h2>
<p>Podemos filtrar os dados de cada período e em seguida calcular a média da unidade 1:</p>
<div class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>so[so[<span class="st">"periodo"</span>] <span class="op">==</span> <span class="st">"2017.1"</span>][<span class="st">"nota_1"</span>].mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="21">
<pre><code>7.595238095238097</code></pre>
</div>
</div>
<div class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>so[so[<span class="st">"periodo"</span>] <span class="op">==</span> <span class="st">"2017.2"</span>][<span class="st">"nota_1"</span>].mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="22">
<pre><code>7.457692307692308</code></pre>
</div>
</div>
<p>Da mesma forma, podemos ver a fração de alunos com nota acima da média na unidade 1:</p>
<div class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="bu">len</span>(so[(so[<span class="st">"periodo"</span>] <span class="op">==</span> <span class="st">"2017.1"</span>) <span class="op">&amp;</span> (so[<span class="st">"nota_1"</span>] <span class="op">&gt;=</span> <span class="dv">7</span>)].index) <span class="op">/</span> <span class="bu">len</span>(so[(so[<span class="st">"periodo"</span>] <span class="op">==</span> <span class="st">"2017.1"</span>)].index)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="42">
<pre><code>0.7619047619047619</code></pre>
</div>
</div>
<div class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a> <span class="bu">len</span>(so[(so[<span class="st">"periodo"</span>] <span class="op">==</span> <span class="st">"2017.2"</span>) <span class="op">&amp;</span> (so[<span class="st">"nota_1"</span>] <span class="op">&gt;=</span> <span class="dv">7</span>)].index) <span class="op">/</span> <span class="bu">len</span>(so[(so[<span class="st">"periodo"</span>] <span class="op">==</span> <span class="st">"2017.2"</span>)].index)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="43">
<pre><code>0.7307692307692307</code></pre>
</div>
</div>
<p>Existe uma forma mais adequada para fazer esse tipo de cálculo agrupado por categoria.</p>
</section>
<section id="agrupando-por-coluna-e-sumarizando-dados" class="level2">
<h2 class="anchored" data-anchor-id="agrupando-por-coluna-e-sumarizando-dados">Agrupando por coluna e sumarizando dados</h2>
<p>A função <code>groupby</code> agrupa os dados de acordo com categorias definidas pelas colunas e aplica funções para cada grupo. A função <code>summarise</code> aplica uma função para cada grupo de dados, gerando novas colunas no data frame.</p>
<p>Vamos usar como exemplo o cálculo da média para cada unidade, agrupado por período:</p>
<div class="cell" data-execution_count="51">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>so_media <span class="op">=</span> so.groupby([<span class="st">"periodo"</span>]).mean()</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>so_media</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="51">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>nota_1</th>
      <th>nota_2</th>
      <th>nota_3</th>
      <th>nota_4</th>
    </tr>
    <tr>
      <th>periodo</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2017.1</th>
      <td>7.595238</td>
      <td>8.438095</td>
      <td>7.771429</td>
      <td>6.742857</td>
    </tr>
    <tr>
      <th>2017.2</th>
      <td>7.457692</td>
      <td>7.876923</td>
      <td>6.996154</td>
      <td>5.892308</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>Como fazemos então para calcular a fração de aprovados na unidade 1 para cada período?</p>
<div class="cell" data-execution_count="53">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> prop_aprovados(df, col<span class="op">=</span><span class="st">"nota_1"</span>, nota_aprovacao<span class="op">=</span><span class="dv">7</span>):</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">len</span>(df[df[<span class="st">"nota_1"</span>] <span class="op">&gt;=</span> nota_aprovacao].index) <span class="op">/</span> <span class="bu">len</span>(df.index)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>so.groupby([<span class="st">"periodo"</span>]).<span class="bu">apply</span>(prop_aprovados)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="53">
<pre><code>periodo
2017.1    0.761905
2017.2    0.730769
dtype: float64</code></pre>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>